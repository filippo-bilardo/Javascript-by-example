<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>04.02 - Eventi Finestra Browser</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .section h2 {
            color: #764ba2;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #764ba2;
        }

        .demo-area {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px solid #e9ecef;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: all 0.3s;
            font-weight: bold;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.4);
        }

        .log {
            background: #2d3748;
            color: #48bb78;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            max-height: 250px;
            overflow-y: auto;
            font-size: 13px;
        }

        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #48bb78;
            padding-left: 10px;
        }

        .log-entry.throttled {
            border-left-color: #f6ad55;
            color: #f6ad55;
        }

        .log-entry.debounced {
            border-left-color: #4299e1;
            color: #4299e1;
        }

        .code-display {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            font-size: 14px;
        }

        .stats-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #764ba2;
        }

        .stat-label {
            font-size: 12px;
            color: #718096;
            margin-top: 5px;
        }

        .viewport-display {
            background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            border: 3px solid #667eea;
            margin: 15px 0;
        }

        .viewport-size {
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }

        .scroll-indicator {
            position: fixed;
            top: 0;
            left: 0;
            height: 5px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.1s;
            z-index: 1000;
        }

        .scroll-content {
            height: 300px;
            overflow-y: auto;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }

        .connection-status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
        }

        .connection-status.online {
            background: #c6f6d5;
            color: #22543d;
            border: 2px solid #48bb78;
        }

        .connection-status.offline {
            background: #fed7d7;
            color: #742a2a;
            border: 2px solid #f56565;
        }

        .connection-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            vertical-align: middle;
        }

        .connection-indicator.online {
            background: #48bb78;
            box-shadow: 0 0 10px #48bb78;
            animation: pulse-green 2s infinite;
        }

        .connection-indicator.offline {
            background: #f56565;
            animation: pulse-red 2s infinite;
        }

        @keyframes pulse-green {
            0%, 100% { box-shadow: 0 0 10px #48bb78; }
            50% { box-shadow: 0 0 20px #48bb78; }
        }

        @keyframes pulse-red {
            0%, 100% { box-shadow: 0 0 10px #f56565; }
            50% { box-shadow: 0 0 20px #f56565; }
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 15px 0;
        }

        .comparison-box {
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
            background: white;
        }

        .comparison-box h4 {
            color: #764ba2;
            margin-bottom: 15px;
        }

        .scroll-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s;
            z-index: 999;
        }

        .scroll-to-top.visible {
            opacity: 1;
        }

        .scroll-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .breakpoint-indicator {
            padding: 10px 20px;
            background: #764ba2;
            color: white;
            border-radius: 6px;
            display: inline-block;
            font-weight: bold;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="scroll-indicator" id="scroll-progress"></div>
    <button class="scroll-to-top" id="scroll-to-top" onclick="scrollToTop()">‚Üë</button>

    <div class="container">
        <h1>ü™ü 04.02 - Eventi Finestra Browser</h1>

        <!-- Sezione 1: resize Event -->
        <div class="section">
            <h2>1. resize - Ridimensionamento Finestra</h2>
            <p>Monitora il ridimensionamento della finestra del browser.</p>
            
            <div class="demo-area">
                <div class="viewport-display">
                    <div>Dimensioni Viewport</div>
                    <div class="viewport-size" id="viewport-size">-</div>
                    <div id="breakpoint-display"></div>
                </div>
                
                <div class="stats-display">
                    <div class="stat-card">
                        <div class="stat-value" id="resize-raw-count">0</div>
                        <div class="stat-label">Eventi Raw</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="resize-throttled-count">0</div>
                        <div class="stat-label">Throttled (100ms)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="resize-debounced-count">0</div>
                        <div class="stat-label">Debounced (250ms)</div>
                    </div>
                </div>
                
                <p><strong>üí° Prova:</strong> Ridimensiona la finestra del browser per vedere i contatori aggiornarsi.</p>
                
                <div class="code-display">
// ‚ùå PROBLEMA - Troppi eventi durante resize!
window.addEventListener('resize', function() {
    console.log('Resize'); // Chiamato centinaia di volte!
    adjustLayout(); // Costoso!
});

// ‚úÖ SOLUZIONE 1 - Throttling (max ogni X ms)
let lastThrottle = 0;
window.addEventListener('resize', function() {
    const now = Date.now();
    if (now - lastThrottle > 100) {
        lastThrottle = now;
        adjustLayout();
    }
});

// ‚úÖ SOLUZIONE 2 - Debouncing (esegui dopo silenzio)
let resizeTimeout;
window.addEventListener('resize', function() {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(adjustLayout, 250);
});</div>
            </div>
            <div id="log1" class="log"></div>
        </div>

        <!-- Sezione 2: scroll Event -->
        <div class="section">
            <h2>2. scroll - Scroll della Pagina</h2>
            <p>Monitora lo scroll della finestra o di elementi specifici.</p>
            
            <div class="demo-area">
                <div class="stats-display">
                    <div class="stat-card">
                        <div class="stat-value" id="scroll-y">0</div>
                        <div class="stat-label">Scroll Y (px)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="scroll-percent">0</div>
                        <div class="stat-label">Percentuale (%)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="scroll-direction">-</div>
                        <div class="stat-label">Direzione</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="scroll-events">0</div>
                        <div class="stat-label">Eventi Totali</div>
                    </div>
                </div>
                
                <h4>Scroll Container Locale:</h4>
                <div class="scroll-content" id="local-scroll">
                    <h3>Contenuto Scrollabile</h3>
                    <p>Questo container ha il proprio scroll. Gli eventi scroll NON propagano!</p>
                    <p style="margin: 10px 0;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                    <p style="margin: 10px 0;">Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                    <p style="margin: 10px 0;">Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
                    <p style="margin: 10px 0;">Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                    <p style="margin: 10px 0;">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium.</p>
                    <p style="margin: 10px 0;">Totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
                    <p style="margin: 10px 0;">Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit.</p>
                    <p style="margin: 10px 0;">Sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.</p>
                    <p>Scroll progresso: <span id="local-scroll-percent">0</span>%</p>
                </div>
                
                <div class="code-display">
// Scroll della finestra
window.addEventListener('scroll', function() {
    const scrollY = window.scrollY;
    const scrollPercent = (scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
    
    updateScrollIndicator(scrollPercent);
    
    // Mostra/nascondi bottone "torna su"
    if (scrollY > 300) {
        showScrollToTop();
    } else {
        hideScrollToTop();
    }
});

// Scroll di elemento specifico (NON propaga!)
element.addEventListener('scroll', function() {
    const percent = (this.scrollTop / (this.scrollHeight - this.clientHeight)) * 100;
    updateProgress(percent);
});</div>
            </div>
            <div id="log2" class="log"></div>
        </div>

        <!-- Sezione 3: Throttling vs Debouncing -->
        <div class="section">
            <h2>3. Throttling vs Debouncing - Confronto</h2>
            <p>Tecniche per ottimizzare eventi ad alta frequenza.</p>
            
            <div class="demo-area">
                <div class="comparison-grid">
                    <div class="comparison-box">
                        <h4>‚ö° Throttling</h4>
                        <p><strong>Funzionamento:</strong> Esegue al massimo ogni X millisecondi</p>
                        <p><strong>Quando usare:</strong> scroll, resize, mousemove</p>
                        <p><strong>Esempio:</strong> Aggiornamento posizione durante scroll</p>
                        <div class="stat-card" style="margin-top: 15px;">
                            <div class="stat-value" id="throttle-test">0</div>
                            <div class="stat-label">Esecuzioni (100ms)</div>
                        </div>
                    </div>
                    
                    <div class="comparison-box">
                        <h4>‚è±Ô∏è Debouncing</h4>
                        <p><strong>Funzionamento:</strong> Esegue dopo X ms di silenzio</p>
                        <p><strong>Quando usare:</strong> input search, resize finale, validazione</p>
                        <p><strong>Esempio:</strong> Ricerca mentre digiti</p>
                        <div class="stat-card" style="margin-top: 15px;">
                            <div class="stat-value" id="debounce-test">0</div>
                            <div class="stat-label">Esecuzioni (250ms)</div>
                        </div>
                    </div>
                </div>
                
                <p style="margin-top: 15px;"><strong>üí° Test:</strong> Muovi il mouse nell'area sottostante per vedere le differenze</p>
                <div id="mouse-test-area" style="background: #ebf8ff; padding: 40px; border-radius: 8px; text-align: center; cursor: crosshair; border: 2px solid #4299e1;">
                    <p style="font-size: 24px; color: #2c5282;">Muovi il mouse qui</p>
                    <p style="margin-top: 10px;">Eventi raw: <span id="mouse-raw">0</span></p>
                </div>
                
                <div class="code-display">
// Throttle Function
function throttle(func, delay) {
    let lastCall = 0;
    return function(...args) {
        const now = Date.now();
        if (now - lastCall >= delay) {
            lastCall = now;
            func(...args);
        }
    };
}

// Debounce Function
function debounce(func, delay) {
    let timeoutId;
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => func(...args), delay);
    };
}

// Uso
const throttledScroll = throttle(handleScroll, 100);
const debouncedResize = debounce(adjustLayout, 250);

window.addEventListener('scroll', throttledScroll);
window.addEventListener('resize', debouncedResize);</div>
            </div>
            <div id="log3" class="log"></div>
        </div>

        <!-- Sezione 4: online/offline Events -->
        <div class="section">
            <h2>4. online/offline - Stato Connessione</h2>
            <p>Rileva cambiamenti nello stato della connessione di rete.</p>
            
            <div class="demo-area">
                <div id="connection-status" class="connection-status online">
                    <span class="connection-indicator online"></span>
                    <span id="connection-text">ONLINE - Connessione Attiva</span>
                </div>
                
                <div class="stats-display">
                    <div class="stat-card">
                        <div class="stat-value" id="online-count">0</div>
                        <div class="stat-label">Eventi Online</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="offline-count">0</div>
                        <div class="stat-label">Eventi Offline</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="connection-changes">0</div>
                        <div class="stat-label">Cambiamenti</div>
                    </div>
                </div>
                
                <p><strong>üí° Test:</strong> Disattiva/riattiva la connessione di rete nel tuo sistema operativo</p>
                <p style="margin-top: 10px; color: #718096; font-size: 14px;">
                    Oppure apri DevTools ‚Üí Network tab ‚Üí Throttling ‚Üí Offline
                </p>
                
                <button onclick="simulateOffline()">üì° Simula Offline</button>
                <button onclick="simulateOnline()">‚úÖ Simula Online</button>
                
                <div class="code-display">
// Rileva stato online
window.addEventListener('online', function() {
    console.log('‚úÖ Connessione ripristinata');
    
    // Sincronizza dati pending
    syncPendingData();
    
    // Mostra notifica
    showNotification('Connessione ripristinata');
    
    // Riprendi richieste in pausa
    resumeAPIRequests();
});

// Rileva stato offline
window.addEventListener('offline', function() {
    console.log('‚ùå Connessione persa');
    
    // Attiva modalit√† offline
    enableOfflineMode();
    
    // Salva dati localmente
    saveToLocalStorage();
    
    // Mostra avviso
    showOfflineWarning();
});

// Controlla stato corrente
if (navigator.onLine) {
    console.log('Online');
} else {
    console.log('Offline');
}</div>
            </div>
            <div id="log4" class="log"></div>
        </div>

        <!-- Sezione 5: Responsive Breakpoints -->
        <div class="section">
            <h2>5. Responsive Breakpoints con resize</h2>
            <p>Rilevamento breakpoints responsive in JavaScript.</p>
            
            <div class="demo-area">
                <h4>Breakpoint Corrente:</h4>
                <div class="breakpoint-indicator" id="current-breakpoint">-</div>
                
                <table style="width: 100%; margin: 20px 0; border-collapse: collapse;">
                    <thead style="background: #764ba2; color: white;">
                        <tr>
                            <th style="padding: 10px; text-align: left;">Breakpoint</th>
                            <th style="padding: 10px; text-align: left;">Range</th>
                            <th style="padding: 10px; text-align: left;">Stato</th>
                        </tr>
                    </thead>
                    <tbody id="breakpoint-table">
                    </tbody>
                </table>
                
                <div class="code-display">
// Definisci breakpoints
const breakpoints = {
    mobile: { max: 576 },
    tablet: { min: 577, max: 768 },
    desktop: { min: 769, max: 1024 },
    wide: { min: 1025 }
};

// Rileva breakpoint corrente
function getCurrentBreakpoint() {
    const width = window.innerWidth;
    
    for (const [name, range] of Object.entries(breakpoints)) {
        const minMatch = !range.min || width >= range.min;
        const maxMatch = !range.max || width <= range.max;
        
        if (minMatch && maxMatch) {
            return name;
        }
    }
    return 'unknown';
}

// Monitora cambiamenti
let currentBreakpoint = getCurrentBreakpoint();

window.addEventListener('resize', debounce(function() {
    const newBreakpoint = getCurrentBreakpoint();
    
    if (newBreakpoint !== currentBreakpoint) {
        console.log(`Breakpoint changed: ${currentBreakpoint} ‚Üí ${newBreakpoint}`);
        currentBreakpoint = newBreakpoint;
        onBreakpointChange(newBreakpoint);
    }
}, 250));</div>
            </div>
            <div id="log5" class="log"></div>
        </div>

    </div>

    <script>
        // Utility logging
        function addLog(logId, message, type = 'info') {
            const log = document.getElementById(logId);
            if (!log) return;
            
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
            
            // Limita log entries
            if (log.children.length > 50) {
                log.removeChild(log.firstChild);
            }
        }

        // Sezione 1: resize Event
        let resizeRawCount = 0;
        let resizeThrottledCount = 0;
        let resizeDebouncedCount = 0;
        let lastThrottle = 0;
        let resizeDebounceTimeout;

        function updateViewportSize() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            document.getElementById('viewport-size').textContent = `${width} √ó ${height}`;
            
            // Breakpoint
            const bp = getCurrentBreakpoint();
            const bpDisplay = document.getElementById('breakpoint-display');
            bpDisplay.innerHTML = `<div class="breakpoint-indicator">${bp.toUpperCase()}</div>`;
        }

        window.addEventListener('resize', function() {
            resizeRawCount++;
            document.getElementById('resize-raw-count').textContent = resizeRawCount;
            
            updateViewportSize();
            
            // Throttling
            const now = Date.now();
            if (now - lastThrottle >= 100) {
                lastThrottle = now;
                resizeThrottledCount++;
                document.getElementById('resize-throttled-count').textContent = resizeThrottledCount;
                addLog('log1', `‚ö° Throttled resize: ${window.innerWidth}√ó${window.innerHeight}`, 'throttled');
            }
            
            // Debouncing
            clearTimeout(resizeDebounceTimeout);
            resizeDebounceTimeout = setTimeout(function() {
                resizeDebouncedCount++;
                document.getElementById('resize-debounced-count').textContent = resizeDebouncedCount;
                addLog('log1', `‚è±Ô∏è Debounced resize: ${window.innerWidth}√ó${window.innerHeight}`, 'debounced');
            }, 250);
        });

        updateViewportSize();
        addLog('log1', 'üí° Ridimensiona la finestra per vedere throttling e debouncing in azione');

        // Sezione 2: scroll Event
        let scrollEventCount = 0;
        let lastScrollY = 0;

        function updateScrollProgress() {
            const scrollY = window.scrollY;
            const scrollHeight = document.documentElement.scrollHeight;
            const clientHeight = window.innerHeight;
            const scrollPercent = Math.round((scrollY / (scrollHeight - clientHeight)) * 100);
            
            document.getElementById('scroll-y').textContent = Math.round(scrollY);
            document.getElementById('scroll-percent').textContent = scrollPercent;
            
            // Direzione
            const direction = scrollY > lastScrollY ? '‚¨áÔ∏è Down' : scrollY < lastScrollY ? '‚¨ÜÔ∏è Up' : '-';
            document.getElementById('scroll-direction').textContent = direction;
            lastScrollY = scrollY;
            
            // Progress bar
            document.getElementById('scroll-progress').style.width = scrollPercent + '%';
            
            // Scroll to top button
            const btn = document.getElementById('scroll-to-top');
            if (scrollY > 300) {
                btn.classList.add('visible');
            } else {
                btn.classList.remove('visible');
            }
        }

        let scrollThrottle = 0;
        window.addEventListener('scroll', function() {
            scrollEventCount++;
            document.getElementById('scroll-events').textContent = scrollEventCount;
            
            const now = Date.now();
            if (now - scrollThrottle >= 50) {
                scrollThrottle = now;
                updateScrollProgress();
            }
        });

        // Local scroll
        document.getElementById('local-scroll').addEventListener('scroll', function() {
            const percent = Math.round((this.scrollTop / (this.scrollHeight - this.clientHeight)) * 100);
            document.getElementById('local-scroll-percent').textContent = percent || 0;
            addLog('log2', `üìú Container scroll: ${percent}%`);
        });

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            addLog('log2', '‚¨ÜÔ∏è Scroll to top');
        }

        updateScrollProgress();
        addLog('log2', 'üí° Scrolla la pagina e il container per vedere gli eventi');

        // Sezione 3: Throttling vs Debouncing
        let mouseRawCount = 0;
        let throttleTestCount = 0;
        let debounceTestCount = 0;
        let mouseThrottle = 0;
        let mouseDebounceTimeout;

        document.getElementById('mouse-test-area').addEventListener('mousemove', function() {
            mouseRawCount++;
            document.getElementById('mouse-raw').textContent = mouseRawCount;
            
            // Throttle
            const now = Date.now();
            if (now - mouseThrottle >= 100) {
                mouseThrottle = now;
                throttleTestCount++;
                document.getElementById('throttle-test').textContent = throttleTestCount;
            }
            
            // Debounce
            clearTimeout(mouseDebounceTimeout);
            mouseDebounceTimeout = setTimeout(function() {
                debounceTestCount++;
                document.getElementById('debounce-test').textContent = debounceTestCount;
            }, 250);
        });

        addLog('log3', 'üí° Muovi il mouse nell\'area blu per confrontare throttling e debouncing');
        addLog('log3', '   Throttle: esegue ogni 100ms durante movimento');
        addLog('log3', '   Debounce: esegue 250ms DOPO che smetti di muovere');

        // Sezione 4: online/offline
        let onlineCount = 0;
        let offlineCount = 0;
        let connectionChanges = 0;

        function updateConnectionStatus(isOnline) {
            const statusDiv = document.getElementById('connection-status');
            const statusText = document.getElementById('connection-text');
            const indicator = statusDiv.querySelector('.connection-indicator');
            
            connectionChanges++;
            document.getElementById('connection-changes').textContent = connectionChanges;
            
            if (isOnline) {
                statusDiv.className = 'connection-status online';
                indicator.className = 'connection-indicator online';
                statusText.textContent = 'ONLINE - Connessione Attiva';
                onlineCount++;
                document.getElementById('online-count').textContent = onlineCount;
                addLog('log4', '‚úÖ ONLINE - Connessione ripristinata');
                addLog('log4', '   ‚Ä¢ Sincronizzazione dati possibile');
                addLog('log4', '   ‚Ä¢ API requests riprese');
            } else {
                statusDiv.className = 'connection-status offline';
                indicator.className = 'connection-indicator offline';
                statusText.textContent = 'OFFLINE - Nessuna Connessione';
                offlineCount++;
                document.getElementById('offline-count').textContent = offlineCount;
                addLog('log4', '‚ùå OFFLINE - Connessione persa');
                addLog('log4', '   ‚Ä¢ Modalit√† offline attivata');
                addLog('log4', '   ‚Ä¢ Dati salvati localmente');
            }
        }

        window.addEventListener('online', function() {
            updateConnectionStatus(true);
        });

        window.addEventListener('offline', function() {
            updateConnectionStatus(false);
        });

        function simulateOffline() {
            addLog('log4', 'üîß Simulazione offline (solo UI, non reale)');
            updateConnectionStatus(false);
        }

        function simulateOnline() {
            addLog('log4', 'üîß Simulazione online (solo UI, non reale)');
            updateConnectionStatus(true);
        }

        // Stato iniziale
        updateConnectionStatus(navigator.onLine);
        addLog('log4', `üí° Stato corrente: ${navigator.onLine ? 'ONLINE' : 'OFFLINE'}`);
        addLog('log4', '   Disattiva/riattiva la rete per testare gli eventi');

        // Sezione 5: Breakpoints
        const breakpoints = {
            mobile: { max: 576, label: '‚â§ 576px' },
            tablet: { min: 577, max: 768, label: '577-768px' },
            desktop: { min: 769, max: 1024, label: '769-1024px' },
            wide: { min: 1025, label: '‚â• 1025px' }
        };

        function getCurrentBreakpoint() {
            const width = window.innerWidth;
            
            for (const [name, range] of Object.entries(breakpoints)) {
                const minMatch = !range.min || width >= range.min;
                const maxMatch = !range.max || width <= range.max;
                
                if (minMatch && maxMatch) {
                    return name;
                }
            }
            return 'unknown';
        }

        function updateBreakpointTable() {
            const tbody = document.getElementById('breakpoint-table');
            const current = getCurrentBreakpoint();
            
            tbody.innerHTML = '';
            for (const [name, range] of Object.entries(breakpoints)) {
                const isCurrent = name === current;
                const row = document.createElement('tr');
                row.style.background = isCurrent ? '#f0fff4' : 'white';
                row.innerHTML = `
                    <td style="padding: 10px; font-weight: ${isCurrent ? 'bold' : 'normal'}; color: ${isCurrent ? '#22543d' : 'inherit'};">
                        ${isCurrent ? '‚úÖ ' : ''}${name.toUpperCase()}
                    </td>
                    <td style="padding: 10px;">${range.label}</td>
                    <td style="padding: 10px;">${isCurrent ? 'ATTIVO' : '-'}</td>
                `;
                tbody.appendChild(row);
            }
        }

        let currentBreakpoint = getCurrentBreakpoint();
        document.getElementById('current-breakpoint').textContent = currentBreakpoint.toUpperCase();

        let breakpointDebounce;
        window.addEventListener('resize', function() {
            clearTimeout(breakpointDebounce);
            breakpointDebounce = setTimeout(function() {
                const newBreakpoint = getCurrentBreakpoint();
                
                if (newBreakpoint !== currentBreakpoint) {
                    addLog('log5', `üîÑ Breakpoint: ${currentBreakpoint} ‚Üí ${newBreakpoint}`);
                    currentBreakpoint = newBreakpoint;
                    document.getElementById('current-breakpoint').textContent = newBreakpoint.toUpperCase();
                }
                
                updateBreakpointTable();
            }, 250);
        });

        updateBreakpointTable();
        addLog('log5', 'üí° Ridimensiona per vedere i cambiamenti di breakpoint');
        addLog('log5', `   Breakpoint corrente: ${currentBreakpoint}`);
    </script>
</body>
</html>
